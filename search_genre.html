<!DOCTYPE html>
<html>

	<head>
		<title>Jones DVD Search</title>
		<link rel="stylesheet" type="text/css" href="resources/css/bootstrap-custom.css"/>
		
		<script type="text/javascript" src='libraries/jquery/js/jquery-1.11.0.js'></script>
		<script type="text/javascript" src='resources/js/DisplaySearch.js'></script>
		<script type="text/javascript">
			$(document).ready(function(){

				$('#header').load('header.html');
				
				$('#searchResultsWrapper').hide();
				$('#loading').hide();
				$('.last-updated').hide();

				var get_results = window.location.search.substring(1);
				var search_term = get_results.split("=");

				// If there isn't a genre change the first tile to say "Pick a genre" and return
				if (search_term[1] == undefined){
					$("#genre-title").html("Choose a Genre...");
					return;
				}

				// Make the genre selected yellow.
				var genreWithSpaces = search_term[1].replace("_", " ");

				console.log(genreWithSpaces);
				($("a:contains('" + genreWithSpaces + "')").parent()).attr("class", "active");
				$("#genre-title").html("Genre: " + genreWithSpaces);

				$.get("resources/php/search.php?genre=" + search_term[1],
					function(response){
						displaySearchResults(response);
					},
					"json");
				});

				$(document).ajaxStart(function(){
					$('#loading').html("<img id=\"loading\" src=\"resources/images/Loader.gif\"></img>");
					$('#loading').fadeIn(1000);
				});

				$(document).ajaxStop(function(){
					$('#loading').fadeOut(700, function(){
						$('#searchResultsWrapper').fadeIn(700);
					});
				});

		</script>
		
	</head>

	<body>
		<div id="header"></div>

		<h2 id="genre-title"></h2>
		<ul class="nav nav-pills nav-genre">
			<li><a href="search_genre.html?genre=adventure">adventure</a></li>
			<li><a href="search_genre.html?genre=animation">animation</a></li>
			<li><a href="search_genre.html?genre=children">children's</a></li>
			<li><a href="search_genre.html?genre=comedy">comedy</a></li>
			<li><a href="search_genre.html?genre=crime">crime</a></li>
			<li><a href="search_genre.html?genre=documentary">documentary</a></li>
			<li><a href="search_genre.html?genre=drama">drama</a></li>
			<li><a href="search_genre.html?genre=historical">historical</a></li>
			<li><a href="search_genre.html?genre=horror">horror</a></li>
			<li><a href="search_genre.html?genre=romance">romance</a></li>
			<li><a href="search_genre.html?genre=science_fiction">science fiction</a></li>
			<li><a href="search_genre.html?genre=television_programs">television programs</a></li>
			<li><a href="search_genre.html?genre=war">war</a></li>
			<li><a href="search_genre.html?genre=western">western</a></li>
		</ul>

		<!-- Loading Image. Only shown when AXAJ call has been made and hasn't returned. -->
		<div id="loading"></div>

		<!-- Where search results will be displayed -->
		<div id="searchResultsWrapper">
			<div id="searchResults"></div>
		</div>

		<p class="last-updated"><a href="google.com">google</a></p>

	</body>

</html>
